[General]
# Shadowrocket Config for CapCut Pro Unlock
# Complete Configuration with Scripts
# Version: 2.0
# Updated: 2024

bypass-system = true
skip-proxy = 192.168.0.0/16, 10.0.0.0/8, 172.16.0.0/12, localhost, *.local, captive.apple.com
tun-excluded-routes = 10.0.0.0/8, 100.64.0.0/10, 127.0.0.0/8, 169.254.0.0/16, 172.16.0.0/12, 192.0.0.0/24, 192.0.2.0/24, 192.88.99.0/24, 192.168.0.0/16, 198.51.100.0/24, 203.0.113.0/24, 224.0.0.0/4, 255.255.255.255/32
dns-server = system, 8.8.8.8, 1.1.1.1
fallback-dns-server = system
ipv6 = false
prefer-ipv6 = false
dns-fallback-system = false
dns-direct-system = false
icmp-auto-reply = true
always-reject-url-rewrite = false
private-ip-answer = true
dns-direct-fallback-proxy = true
udp-policy-not-supported-behaviour = REJECT
update-url = https://raw.githubusercontent.com/capcut-mod/capcut-pro/main/capcut-pro.conf

[Proxy]
# Add your proxy servers here
# Example:
# DIRECT = direct
# PROXY = https, server, port, username, password, skip-cert-verify=false

[Proxy Group]
# Auto Group
Auto = url-test, PROXY, url = http://www.gstatic.com/generate_204, interval = 600
# Fallback Group
Fallback = fallback, PROXY, url = http://www.gstatic.com/generate_204, interval = 600
# Load Balance
LoadBalance = load-balance, PROXY, url = http://www.gstatic.com/generate_204, interval = 600

[Rule]
# CapCut Main Domains
DOMAIN-SUFFIX,capcutapi.com,PROXY
DOMAIN-SUFFIX,capcut.com,PROXY
DOMAIN-SUFFIX,capcut.net,PROXY
DOMAIN-SUFFIX,capcutstatic.com,PROXY
DOMAIN-SUFFIX,faceueditor.com,PROXY
DOMAIN-SUFFIX,faceulv.com,PROXY
DOMAIN-SUFFIX,faceucam.com,PROXY
DOMAIN-SUFFIX,ibyteimg.com,PROXY
DOMAIN-SUFFIX,byteoversea.com,PROXY
DOMAIN-SUFFIX,pipopay.com,PROXY
DOMAIN-SUFFIX,pipopayment.us,PROXY
DOMAIN-SUFFIX,capcutshare.com,PROXY
DOMAIN-SUFFIX,vodupload.com,PROXY
DOMAIN-SUFFIX,hypic.com,PROXY

# ByteDance/TikTok Domains
DOMAIN-SUFFIX,snssdk.com,PROXY
DOMAIN-SUFFIX,tiktokv.com,PROXY
DOMAIN-SUFFIX,tiktok.com,PROXY
DOMAIN-SUFFIX,byteintlapi.com,PROXY
DOMAIN-SUFFIX,byteintl.net,PROXY
DOMAIN-SUFFIX,isnssdk.com,PROXY
DOMAIN-SUFFIX,sgsnssdk.com,PROXY
DOMAIN-SUFFIX,pangle.io,PROXY
DOMAIN-SUFFIX,bytegecko-i18n.com,PROXY
DOMAIN-SUFFIX,tiktokcdn.com,PROXY
DOMAIN-SUFFIX,ibytedtos.com,PROXY

# Critical CapCut API Servers
DOMAIN,commerce-api.capcutapi.com,PROXY
DOMAIN,editor-api.capcutapi.com,PROXY
DOMAIN,feed-api.capcutapi.com,PROXY
DOMAIN,passport-api.capcutapi.com,PROXY
DOMAIN,mweb-api.capcutapi.com,PROXY
DOMAIN,aivideo-normal.capcutapi.com,PROXY
DOMAIN,evercloud.capcutapi.com,PROXY
DOMAIN,sdksg-normal.evercloud.capcutapi.com,PROXY
DOMAIN,sdkva-normal.evercloud.capcutapi.com,PROXY
DOMAIN,sdksggcp-normal.evercloud.capcutapi.com,PROXY

# Premium Feature Servers
DOMAIN,commerce16-normal-mya.capcutapi.com,PROXY
DOMAIN,commerce16-normal-myb.capcutapi.com,PROXY
DOMAIN,commerce32-normal-mya.capcutapi.com,PROXY
DOMAIN,commerce32-normal-myb.capcutapi.com,PROXY
DOMAIN,editor16-normal-mya.capcutapi.com,PROXY
DOMAIN,editor16-normal-myb.capcutapi.com,PROXY
DOMAIN,editor32-normal-mya.capcutapi.com,PROXY
DOMAIN,editor32-normal-myb.capcutapi.com,PROXY
DOMAIN,feed16-normal-mya.capcutapi.com,PROXY
DOMAIN,feed16-normal-myb.capcutapi.com,PROXY
DOMAIN,feed32-normal-mya.capcutapi.com,PROXY
DOMAIN,feed32-normal-myb.capcutapi.com,PROXY

# Singapore Servers (Most Premium Features)
DOMAIN,commerce16-normal-sg.capcutapi.com,PROXY
DOMAIN,commerce32-normal-sg.capcutapi.com,PROXY
DOMAIN,editor16-normal-sg.capcutapi.com,PROXY
DOMAIN,editor32-normal-sg.capcutapi.com,PROXY
DOMAIN,feed16-normal-sg.capcutapi.com,PROXY
DOMAIN,feed32-normal-sg.capcutapi.com,PROXY
DOMAIN,passport16-normal-sg.capcutapi.com,PROXY
DOMAIN,passport32-normal-sg.capcutapi.com,PROXY

# Payment Servers
DOMAIN,pay16-normal-alisg.pipopay.com,PROXY
DOMAIN,pay22-normal-alisg.pipopay.com,PROXY
DOMAIN,pay16-normal-useast1a.pipopay.com,PROXY
DOMAIN,pay22-normal-useast1a.pipopay.com,PROXY

# CDN & Static Content
DOMAIN,lf16-tos-sg.capcutstatic.com,PROXY
DOMAIN,lf16-tos-va.capcutstatic.com,PROXY
DOMAIN,p16-capcut-sign-sg.ibyteimg.com,PROXY
DOMAIN,p16-heycan-image-sign-sg.ibyteimg.com,PROXY
DOMAIN,p16-heycan-file-sign-sg.ibyteimg.com,PROXY
DOMAIN,p16-ulike-sg.ibyteimg.com,PROXY

# Logging & Monitoring
DOMAIN,log-sg.capcutapi.com,PROXY
DOMAIN,log.byteoversea.com,PROXY
DOMAIN,mon-sg.capcutapi.com,PROXY
DOMAIN,i-sg.capcutapi.com,PROXY
DOMAIN,gecko-sg.capcutapi.com,PROXY
DOMAIN,mssdk-sg.capcutapi.com,PROXY

# IP Ranges
IP-CIDR,199.103.24.0/24,PROXY,no-resolve
IP-CIDR,52.74.2.0/24,PROXY,no-resolve
IP-CIDR,3.229.179.0/24,PROXY,no-resolve
IP-CIDR,71.18.222.0/24,PROXY,no-resolve

# Final Rules
DOMAIN-KEYWORD,capcut,PROXY
DOMAIN-KEYWORD,byte,PROXY
GEOIP,CN,DIRECT
FINAL,PROXY

[Rewrite]
# Premium Feature Redirection
^https?:\/\/commerce-normal\.capcutapi\.com\/ url 302 https://commerce16-normal-mya.capcutapi.com/
^https?:\/\/editor-normal\.capcutapi\.com\/ url 302 https://editor16-normal-mya.capcutapi.com/
^https?:\/\/feed-normal\.capcutapi\.com\/ url 302 https://feed16-normal-mya.capcutapi.com/
^https?:\/\/passport-normal\.capcutapi\.com\/ url 302 https://passport16-normal-sg.capcutapi.com/
^https?:\/\/commerce-api\.capcutapi\.com\/ url 302 https://commerce16-normal-mya.capcutapi.com/
^https?:\/\/editor-api\.capcutapi\.com\/ url 302 https://editor16-normal-mya.capcutapi.com/
^https?:\/\/feed-api\.capcutapi\.com\/ url 302 https://feed16-normal-mya.capcutapi.com/

# API Version Control
^https?:\/\/.*\.capcutapi\.com\/commerce\/v1\/(.*) url 302 https://commerce16-normal-mya.capcutapi.com/commerce/v3/$1
^https?:\/\/.*\.capcutapi\.com\/lv\/v1\/(.*) url 302 https://feed16-normal-mya.capcutapi.com/lv/v2/$1

# Remove Watermark
^https?:\/\/.*\.capcutapi\.com\/video\/export\/request url request-header (\r\n)X-CC-Watermark:.*$1 request-header $1X-CC-Watermark: false$1

# Enable 4K Export
^https?:\/\/.*\.capcutapi\.com\/video\/export\/settings url request-body "max_quality":"1080p" request-body "max_quality":"4k"

# Unlock Templates
^https?:\/\/.*\.capcutapi\.com\/template\/(list|detail) url request-body "is_pro":true request-body "is_pro":false
^https?:\/\/.*\.capcutapi\.com\/template\/(list|detail) url request-body "pro":1 request-body "pro":0

# Bypass Regional Restrictions
^https?:\/\/.*\.faceueditor\.com\/region\/check url response-body "restricted":true response-body "restricted":false
^https?:\/\/.*\.capcutapi\.com\/region\/verify url response-body "blocked":true response-body "blocked":false

[Script]
# Main unlock script
capcut-main = type=http-response,pattern=^https?://.*\.capcutapi\.com/.*,requires-body=1,script-path=https://raw.githubusercontent.com/quocchienn/capcutxyz/refs/heads/main/capcut-pro.js

# User premium status
user-premium = type=http-response,pattern=^https?://.*\.capcutapi\.com/(user/|subscription/),requires-body=1,script-path=https://raw.githubusercontent.com/quocchienn/capcutxyz/refs/heads/main/user-premium.js

# Template unlock
template-unlock = type=http-response,pattern=^https?://.*\.capcutapi\.com/template/,requires-body=1,script-path=https://raw.githubusercontent.com/quocchienn/capcutxyz/refs/heads/main/template-unlock.js

# AI features unlock
ai-unlock = type=http-response,pattern=^https?://.*\.capcutapi\.com/(ai/|smart/|aigc/),requires-body=1,script-path=https://raw.githubusercontent.com/quocchienn/capcutxyz/refs/heads/main/ai-unlock.js
# Export settings unlock
export-unlock = type=http-response,pattern=^https?://.*\.capcutapi\.com/(export/|video/export),requires-body=1,script-path=https://raw.githubusercontent.com/quocchienn/capcutxyz/refs/heads/main/export-unlock.js

# Daily check (cron job)
daily-check = type=cron,cronexp=0 9 * * *,script-path=https://raw.githubusercontent.com/quocchienn/capcutxyz/refs/heads/main/daily-check.js

[MITM]
enable = true
hostname = *.capcutapi.com, *.capcut.com, *.faceueditor.com, *.byteoversea.com, *.pipopay.com, *.capcutstatic.com, *.ibyteimg.com

# Certificate settings
skip-server-cert-verify = false
h2 = true

[URL Rewrite]
# Short URL Redirects
^https?:\/\/capcut\.com\/t\/\w+ url 302 https://capcut.com/template/
^https?:\/\/capcut\.com\/e\/\w+ url 302 https://capcut.com/effect/
^https?:\/\/capcut\.com\/s\/\w+ url 302 https://capcut.com/sound/

# App Store Bypass
^https?:\/\/apps\.apple\.com\/.*capcut.* url reject
^https?:\/\/itunes\.apple\.com\/.*capcut.* url reject

[Header Rewrite]
# Add Premium Headers
^https?:\/\/.*\.capcutapi\.com\/.* request-header X-Premium-User true
^https?:\/\/.*\.capcutapi\.com\/.* request-header X-VIP-Level 3
^https?:\/\/.*\.capcutapi\.com\/.* request-header X-Subscription-Active true

# Remove Analytics
^https?:\/\/.*\.capcutapi\.com\/.* request-header \r\nX-Device-ID:.* $1
^https?:\/\/.*\.capcutapi\.com\/.* request-header \r\nX-Track-ID:.* $1

[Host]
# DNS Override for CapCut
*.capcutapi.com = server:199.103.24.2
*.capcut.com = server:199.103.24.2
*.faceueditor.com = server:199.103.24.2
i18n-api.faceueditor.com = server:199.103.24.2
i18n-feed-api.faceueditor.com = server:199.103.24.2
commerce-api.capcutapi.com = server:199.103.24.2
editor-api.capcutapi.com = server:199.103.24.2
feed-api.capcutapi.com = server:199.103.24.2

# Localhost for Testing
localhost = 127.0.0.1
*.local = 127.0.0.1

[SSID Setting]
# Auto enable on specific WiFi
"Your-WiFi-SSID" = proxy, direct
"Another-WiFi" = proxy, direct
* = proxy, direct